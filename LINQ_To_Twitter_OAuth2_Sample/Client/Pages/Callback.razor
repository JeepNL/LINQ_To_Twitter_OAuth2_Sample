@page "/l2tcallback"
@inject Blazored.LocalStorage.ILocalStorageService localStorage
@inject NavigationManager NavMan

@code {
    [Parameter][SupplyParameterFromQuery] public string access_token { get; set; }
    [Parameter][SupplyParameterFromQuery] public string refresh_token { get; set; }
    [Parameter][SupplyParameterFromQuery] public long expire_token_ticks { get; set; }
    [Parameter][SupplyParameterFromQuery] public string access_denied { get; set; }

    protected override async Task OnInitializedAsync()
    {
        if (access_denied != "true")
        {
            L2TBase l2tBase = new(access_token,
                                  refresh_token,
                                  expire_token_ticks);

            await localStorage.SetItemAsync<L2TBase>("l2t_base", l2tBase);
        }
        NavMan.NavigateTo("/");
    }
}
